{"remainingRequest":"/Users/guohechuan/code/aurora/node_modules/babel-loader/lib/index.js!/Users/guohechuan/code/aurora/node_modules/eslint-loader/index.js??ref--13-0!/Users/guohechuan/code/aurora/src/assets/lib/linenumber.js","dependencies":[{"path":"/Users/guohechuan/code/aurora/src/assets/lib/linenumber.js","mtime":1626163653602},{"path":"/Users/guohechuan/code/aurora/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/guohechuan/code/aurora/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/guohechuan/code/aurora/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltIjsKaW1wb3J0IF90eXBlb2YgZnJvbSAiL1VzZXJzL2d1b2hlY2h1YW4vY29kZS9hdXJvcmEvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZiI7CmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxpbmVudW1iZXIoaGxqcykgewogIHZhciB3ID0gd2luZG93OwogIHZhciBkID0gZG9jdW1lbnQ7CiAgdmFyIFRBQkxFX05BTUUgPSAnaGxqcy1sbicsCiAgICAgIExJTkVfTkFNRSA9ICdobGpzLWxuLWxpbmUnLAogICAgICBDT0RFX0JMT0NLX05BTUUgPSAnaGxqcy1sbi1jb2RlJywKICAgICAgTlVNQkVSU19CTE9DS19OQU1FID0gJ2hsanMtbG4tbnVtYmVycycsCiAgICAgIE5VTUJFUl9MSU5FX05BTUUgPSAnaGxqcy1sbi1uJywKICAgICAgREFUQV9BVFRSX05BTUUgPSAnZGF0YS1saW5lLW51bWJlcicsCiAgICAgIEJSRUFLX0xJTkVfUkVHRVhQID0gL1xyXG58XHJ8XG4vZzsKICB3LmhsanMgPSBobGpzOwogIHcuaGxqcy5pbml0TGluZU51bWJlcnNPbkxvYWQgPSBpbml0TGluZU51bWJlcnNPbkxvYWQ7CiAgdy5obGpzLmxpbmVOdW1iZXJzQmxvY2sgPSBsaW5lTnVtYmVyc0Jsb2NrOwogIHcuaGxqcy5saW5lTnVtYmVyc1ZhbHVlID0gbGluZU51bWJlcnNWYWx1ZTsKICBhZGRTdHlsZXMoKTsKCiAgZnVuY3Rpb24gYWRkU3R5bGVzKCkgewogICAgdmFyIGNzcyA9IGQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgIGNzcy50eXBlID0gJ3RleHQvY3NzJzsKICAgIGNzcy5pbm5lckhUTUwgPSBmb3JtYXQoJy57MH17Ym9yZGVyLWNvbGxhcHNlOmNvbGxhcHNlfScgKyAnLnsxfTpiZWZvcmV7Y29udGVudDphdHRyKHsyfSl9JywgW1RBQkxFX05BTUUsIE5VTUJFUl9MSU5FX05BTUUsIERBVEFfQVRUUl9OQU1FXSk7CiAgICBkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQoY3NzKTsKICB9CgogIGZ1bmN0aW9uIGluaXRMaW5lTnVtYmVyc09uTG9hZChvcHRpb25zKSB7CiAgICB0cnkgewogICAgICB2YXIgdGFyZ2V0RWxlbWVudCA9IGQucXVlcnlTZWxlY3RvcihvcHRpb25zLnRhcmdldCk7CiAgICAgIHZhciBibG9ja3MgPSB0YXJnZXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2NvZGVbY2xhc3MqPSJsYW5ndWFnZS0iXScpOwoKICAgICAgZm9yICh2YXIgaSBpbiBibG9ja3MpIHsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGJsb2NrcywgaSkpIHsKICAgICAgICAgIGxpbmVOdW1iZXJzQmxvY2soYmxvY2tzW2ldLCBvcHRpb25zKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgdy5jb25zb2xlLmVycm9yKCdMaW5lTnVtYmVycyBlcnJvcjogJywgZSk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBsaW5lTnVtYmVyc0Jsb2NrKGVsZW1lbnQsIG9wdGlvbnMpIHsKICAgIGlmIChfdHlwZW9mKGVsZW1lbnQpICE9PSAnb2JqZWN0JykgcmV0dXJuOwogICAgYXN5bmMoZnVuY3Rpb24gKCkgewogICAgICBlbGVtZW50LmlubmVySFRNTCA9IGxpbmVOdW1iZXJzSW50ZXJuYWwoZWxlbWVudCwgb3B0aW9ucyk7CiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIGxpbmVOdW1iZXJzVmFsdWUodmFsdWUsIG9wdGlvbnMpIHsKICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSByZXR1cm47CiAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NvZGUnKTsKICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gdmFsdWU7CiAgICByZXR1cm4gbGluZU51bWJlcnNJbnRlcm5hbChlbGVtZW50LCBvcHRpb25zKTsKICB9CgogIGZ1bmN0aW9uIGxpbmVOdW1iZXJzSW50ZXJuYWwoZWxlbWVudCwgb3B0aW9ucykgewogICAgLy8gZGVmaW5lIG9wdGlvbnMgb3Igc2V0IGRlZmF1bHQKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHsKICAgICAgc2luZ2xlTGluZTogZmFsc2UKICAgIH07IC8vIGNvbnZlcnQgb3B0aW9ucwoKICAgIHZhciBmaXJzdExpbmVJbmRleCA9IG9wdGlvbnMuc2luZ2xlTGluZSA/IDAgOiAxOwogICAgZHVwbGljYXRlTXVsdGlsaW5lTm9kZXMoZWxlbWVudCk7CiAgICByZXR1cm4gYWRkTGluZU51bWJlcnNCbG9ja0ZvcihlbGVtZW50LmlubmVySFRNTCwgZmlyc3RMaW5lSW5kZXgpOwogIH0KCiAgZnVuY3Rpb24gYWRkTGluZU51bWJlcnNCbG9ja0ZvcihpbnB1dEh0bWwsIGZpcnN0TGluZUluZGV4KSB7CiAgICB2YXIgbGluZXMgPSBnZXRMaW5lcyhpbnB1dEh0bWwpOyAvLyBpZiBsYXN0IGxpbmUgY29udGFpbnMgb25seSBjYXJyaWFnZSByZXR1cm4gcmVtb3ZlIGl0CgogICAgaWYgKGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdLnRyaW0oKSA9PT0gJycpIHsKICAgICAgbGluZXMucG9wKCk7CiAgICB9CgogICAgaWYgKGxpbmVzLmxlbmd0aCA+IGZpcnN0TGluZUluZGV4KSB7CiAgICAgIHZhciBodG1sID0gJyc7CgogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGxpbmVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGh0bWwgKz0gZm9ybWF0KCc8dHI+JyArICc8dGQgY2xhc3M9InswfSI+JyArICc8ZGl2IGNsYXNzPSJ7MX0gezJ9IiB7M309Ins1fSI+PC9kaXY+JyArICc8L3RkPicgKyAnPHRkIGNsYXNzPSJ7NH0iPicgKyAnPGRpdiBjbGFzcz0iezF9Ij57Nn08L2Rpdj4nICsgJzwvdGQ+JyArICc8L3RyPicsIFtOVU1CRVJTX0JMT0NLX05BTUUsIExJTkVfTkFNRSwgTlVNQkVSX0xJTkVfTkFNRSwgREFUQV9BVFRSX05BTUUsIENPREVfQkxPQ0tfTkFNRSwgaSArIDEsIGxpbmVzW2ldLmxlbmd0aCA+IDAgPyBsaW5lc1tpXSA6ICcgJ10pOwogICAgICB9CgogICAgICByZXR1cm4gZm9ybWF0KCc8dGFibGUgY2xhc3M9InswfSI+ezF9PC90YWJsZT4nLCBbVEFCTEVfTkFNRSwgaHRtbF0pOwogICAgfQoKICAgIHJldHVybiBpbnB1dEh0bWw7CiAgfQogIC8qKgogICAqIFJlY3Vyc2l2ZSBtZXRob2QgZm9yIGZpeCBtdWx0aS1saW5lIGVsZW1lbnRzIGltcGxlbWVudGF0aW9uIGluIGhpZ2hsaWdodC5qcwogICAqIERvaW5nIGRlZXAgcGFzc2FnZSBvbiBjaGlsZCBub2Rlcy4KICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbGVtZW50CiAgICovCgoKICBmdW5jdGlvbiBkdXBsaWNhdGVNdWx0aWxpbmVOb2RlcyhlbGVtZW50KSB7CiAgICB2YXIgbm9kZXMgPSBlbGVtZW50LmNoaWxkTm9kZXM7CgogICAgZm9yICh2YXIgbm9kZSBpbiBub2RlcykgewogICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG5vZGVzLCBub2RlKSkgewogICAgICAgIHZhciBjaGlsZCA9IG5vZGVzW25vZGVdOwoKICAgICAgICBpZiAoZ2V0TGluZXNDb3VudChjaGlsZC50ZXh0Q29udGVudCkgPiAwKSB7CiAgICAgICAgICBpZiAoY2hpbGQuY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGR1cGxpY2F0ZU11bHRpbGluZU5vZGVzKGNoaWxkKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGR1cGxpY2F0ZU11bHRpbGluZU5vZGUoY2hpbGQucGFyZW50Tm9kZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIC8qKgogICAqIE1ldGhvZCBmb3IgZml4IG11bHRpLWxpbmUgZWxlbWVudHMgaW1wbGVtZW50YXRpb24gaW4gaGlnaGxpZ2h0LmpzCiAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudAogICAqLwoKCiAgZnVuY3Rpb24gZHVwbGljYXRlTXVsdGlsaW5lTm9kZShlbGVtZW50KSB7CiAgICB2YXIgY2xhc3NOYW1lID0gZWxlbWVudC5jbGFzc05hbWU7CiAgICBpZiAoIS9obGpzLS8udGVzdChjbGFzc05hbWUpKSByZXR1cm47CiAgICB2YXIgbGluZXMgPSBnZXRMaW5lcyhlbGVtZW50LmlubmVySFRNTCk7CiAgICB2YXIgcmVzdWx0ID0gJyc7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgbGluZVRleHQgPSBsaW5lc1tpXS5sZW5ndGggPiAwID8gbGluZXNbaV0gOiAnICc7CiAgICAgIHJlc3VsdCArPSBmb3JtYXQoJzxzcGFuIGNsYXNzPSJ7MH0iPnsxfTwvc3Bhbj5cbicsIFtjbGFzc05hbWUsIGxpbmVUZXh0XSk7CiAgICB9CgogICAgZWxlbWVudC5pbm5lckhUTUwgPSByZXN1bHQudHJpbSgpOwogIH0KCiAgZnVuY3Rpb24gZ2V0TGluZXModGV4dCkgewogICAgaWYgKHRleHQubGVuZ3RoID09PSAwKSByZXR1cm4gW107CiAgICByZXR1cm4gdGV4dC5zcGxpdChCUkVBS19MSU5FX1JFR0VYUCk7CiAgfQoKICBmdW5jdGlvbiBnZXRMaW5lc0NvdW50KHRleHQpIHsKICAgIHJldHVybiAodGV4dC50cmltKCkubWF0Y2goQlJFQUtfTElORV9SRUdFWFApIHx8IFtdKS5sZW5ndGg7CiAgfQoKICBmdW5jdGlvbiBhc3luYyhmdW5jKSB7CiAgICB3LnNldFRpbWVvdXQoZnVuYywgMCk7CiAgfQogIC8qKgogICAqIHtAbGluayBodHRwczovL3djb2Rlci5naXRodWIuaW8vbm90ZXMvc3RyaW5nLWZvcm1hdC1mb3Itc3RyaW5nLWZvcm1hdGluZy1pbi1qYXZhc2NyaXB0fQogICAqIEBwYXJhbSB7c3RyaW5nfSBmb3JtYXQKICAgKiBAcGFyYW0ge2FycmF5fSBhcmdzCiAgICovCgoKICBmdW5jdGlvbiBmb3JtYXQoZm9ybWF0LCBhcmdzKSB7CiAgICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL1x7KFxkKylcfS9nLCBmdW5jdGlvbiAobSwgbikgewogICAgICByZXR1cm4gYXJnc1tuXSA/IGFyZ3Nbbl0gOiBtOwogICAgfSk7CiAgfQp9"},{"version":3,"sources":["/Users/guohechuan/code/aurora/src/assets/lib/linenumber.js"],"names":["linenumber","hljs","w","window","d","document","TABLE_NAME","LINE_NAME","CODE_BLOCK_NAME","NUMBERS_BLOCK_NAME","NUMBER_LINE_NAME","DATA_ATTR_NAME","BREAK_LINE_REGEXP","initLineNumbersOnLoad","lineNumbersBlock","lineNumbersValue","addStyles","css","createElement","type","innerHTML","format","getElementsByTagName","appendChild","options","targetElement","querySelector","target","blocks","querySelectorAll","i","Object","prototype","hasOwnProperty","call","e","console","error","element","async","lineNumbersInternal","value","singleLine","firstLineIndex","duplicateMultilineNodes","addLineNumbersBlockFor","inputHtml","lines","getLines","length","trim","pop","html","l","nodes","childNodes","node","child","getLinesCount","textContent","duplicateMultilineNode","parentNode","className","test","result","lineText","text","split","match","func","setTimeout","args","replace","m","n"],"mappings":"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","sourcesContent":["export default function linenumber(hljs) {\n  const w = window\n  const d = document\n  const TABLE_NAME = 'hljs-ln',\n    LINE_NAME = 'hljs-ln-line',\n    CODE_BLOCK_NAME = 'hljs-ln-code',\n    NUMBERS_BLOCK_NAME = 'hljs-ln-numbers',\n    NUMBER_LINE_NAME = 'hljs-ln-n',\n    DATA_ATTR_NAME = 'data-line-number',\n    BREAK_LINE_REGEXP = /\\r\\n|\\r|\\n/g\n\n  w.hljs = hljs\n  w.hljs.initLineNumbersOnLoad = initLineNumbersOnLoad\n  w.hljs.lineNumbersBlock = lineNumbersBlock\n  w.hljs.lineNumbersValue = lineNumbersValue\n\n  addStyles()\n\n  function addStyles() {\n    const css = d.createElement('style')\n    css.type = 'text/css'\n    css.innerHTML = format('.{0}{border-collapse:collapse}' + '.{1}:before{content:attr({2})}', [\n      TABLE_NAME,\n      NUMBER_LINE_NAME,\n      DATA_ATTR_NAME,\n    ])\n    d.getElementsByTagName('head')[0].appendChild(css)\n  }\n\n  function initLineNumbersOnLoad(options) {\n    try {\n      const targetElement = d.querySelector(options.target)\n      const blocks = targetElement.querySelectorAll('code[class*=\"language-\"]')\n      for (let i in blocks) {\n        if (Object.prototype.hasOwnProperty.call(blocks, i)) {\n          lineNumbersBlock(blocks[i], options)\n        }\n      }\n    } catch (e) {\n      w.console.error('LineNumbers error: ', e)\n    }\n  }\n\n  function lineNumbersBlock(element, options) {\n    if (typeof element !== 'object') return\n    async(function () {\n      element.innerHTML = lineNumbersInternal(element, options)\n    })\n  }\n\n  function lineNumbersValue(value, options) {\n    if (typeof value !== 'string') return\n\n    const element = document.createElement('code')\n    element.innerHTML = value\n\n    return lineNumbersInternal(element, options)\n  }\n\n  function lineNumbersInternal(element, options) {\n    // define options or set default\n    options = options || {\n      singleLine: false,\n    }\n\n    // convert options\n    const firstLineIndex = options.singleLine ? 0 : 1\n\n    duplicateMultilineNodes(element)\n\n    return addLineNumbersBlockFor(element.innerHTML, firstLineIndex)\n  }\n\n  function addLineNumbersBlockFor(inputHtml, firstLineIndex) {\n    const lines = getLines(inputHtml)\n\n    // if last line contains only carriage return remove it\n    if (lines[lines.length - 1].trim() === '') {\n      lines.pop()\n    }\n\n    if (lines.length > firstLineIndex) {\n      let html = ''\n\n      for (let i = 0, l = lines.length; i < l; i++) {\n        html += format(\n          '<tr>' +\n            '<td class=\"{0}\">' +\n            '<div class=\"{1} {2}\" {3}=\"{5}\"></div>' +\n            '</td>' +\n            '<td class=\"{4}\">' +\n            '<div class=\"{1}\">{6}</div>' +\n            '</td>' +\n            '</tr>',\n          [\n            NUMBERS_BLOCK_NAME,\n            LINE_NAME,\n            NUMBER_LINE_NAME,\n            DATA_ATTR_NAME,\n            CODE_BLOCK_NAME,\n            i + 1,\n            lines[i].length > 0 ? lines[i] : ' ',\n          ]\n        )\n      }\n\n      return format('<table class=\"{0}\">{1}</table>', [TABLE_NAME, html])\n    }\n\n    return inputHtml\n  }\n\n  /**\n   * Recursive method for fix multi-line elements implementation in highlight.js\n   * Doing deep passage on child nodes.\n   * @param {HTMLElement} element\n   */\n  function duplicateMultilineNodes(element) {\n    const nodes = element.childNodes\n    for (let node in nodes) {\n      if (Object.prototype.hasOwnProperty.call(nodes, node)) {\n        const child = nodes[node]\n        if (getLinesCount(child.textContent) > 0) {\n          if (child.childNodes.length > 0) {\n            duplicateMultilineNodes(child)\n          } else {\n            duplicateMultilineNode(child.parentNode)\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Method for fix multi-line elements implementation in highlight.js\n   * @param {HTMLElement} element\n   */\n  function duplicateMultilineNode(element) {\n    const className = element.className\n\n    if (!/hljs-/.test(className)) return\n\n    const lines = getLines(element.innerHTML)\n\n    let result = ''\n    for (let i = 0; i < lines.length; i++) {\n      const lineText = lines[i].length > 0 ? lines[i] : ' '\n      result += format('<span class=\"{0}\">{1}</span>\\n', [className, lineText])\n    }\n\n    element.innerHTML = result.trim()\n  }\n\n  function getLines(text) {\n    if (text.length === 0) return []\n    return text.split(BREAK_LINE_REGEXP)\n  }\n\n  function getLinesCount(text) {\n    return (text.trim().match(BREAK_LINE_REGEXP) || []).length\n  }\n\n  function async(func) {\n    w.setTimeout(func, 0)\n  }\n\n  /**\n   * {@link https://wcoder.github.io/notes/string-format-for-string-formating-in-javascript}\n   * @param {string} format\n   * @param {array} args\n   */\n  function format(format, args) {\n    return format.replace(/\\{(\\d+)\\}/g, function (m, n) {\n      return args[n] ? args[n] : m\n    })\n  }\n}\n"]}]}