{"remainingRequest":"/Users/guohechuan/code/aurora/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/guohechuan/code/aurora/src/views/Home/index.vue?vue&type=style&index=0&lang=scss&scope=true&","dependencies":[{"path":"/Users/guohechuan/code/aurora/src/views/Home/index.vue","mtime":1626163653612},{"path":"/Users/guohechuan/code/aurora/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/guohechuan/code/aurora/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/guohechuan/code/aurora/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/guohechuan/code/aurora/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/guohechuan/code/aurora/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/guohechuan/code/aurora/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKQGltcG9ydCAnLi9pbmRleC5zY3NzJzsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2KA","file":"index.vue","sourceRoot":"src/views/Home","sourcesContent":["<template>\n  <div id=\"home\">\n    <Transition name=\"fade-transform\" mode=\"out-in\">\n      <div v-if=\"posts.length\">\n        <div class=\"content\">\n          <article\n            class=\"cursor\"\n            data-aos=\"fade-up\"\n            v-for=\"(post, index) in posts\"\n            :key=\"post.id\"\n            @mouseenter=\"showTips(post)\"\n          >\n            <router-link :to=\"{ name: 'post', params: { number: post.number, post } }\">\n              <div class=\"post-header\">\n                <Cover\n                  :src=\"post.cover.src\"\n                  :alt=\"post.cover.title\"\n                  :loadCover=\"index < LOAD_INX\"\n                  @loadNext=\"loadNext\"\n                />\n                <div class=\"post-head\">\n                  <h3>{{ post.title }}</h3>\n                  <span>{{ post.cover.title }}</span>\n                </div>\n              </div>\n              <div class=\"post-body\">\n                <MarkDown :content=\"post.description\" />\n              </div>\n              <div class=\"post-meta\">\n                <span>\n                  <i class=\"icon icon-calendar\"></i>\n                  {{ post.created_at }}\n                </span>\n                <span>\n                  <i class=\"icon icon-fire\"></i>\n                  热度{{ times[post.id] || 1 }}℃\n                </span>\n                <span>\n                  <i class=\"icon icon-bookmark-empty\"></i>\n                  {{ post.milestone ? post.milestone.title : '未分类' }}\n                </span>\n                <span>\n                  <i class=\"icon icon-tag\"></i>\n                  <span v-for=\"label in post.labels.slice(0, 2)\" :key=\"label.id\">{{ label.name }}</span>\n                </span>\n              </div>\n            </router-link>\n          </article>\n        </div>\n        <div class=\"btn-group\" v-if=\"!isDisabledPrev || !isDisabledNext\">\n          <Pagination\n            :loading=\"loading\"\n            :isDisabledPrev=\"isDisabledPrev\"\n            :isDisabledNext=\"isDisabledNext\"\n            @handlePage=\"queryPosts\"\n          />\n        </div>\n      </div>\n      <Loading v-else />\n    </Transition>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport AOS from 'aos'\nimport MarkDown from '@/components/MarkDown'\nimport Loading from '@/components/Loading'\nimport Pagination from '@/components/Pagination'\nimport Cover from '@/components/Cover'\n\nexport default {\n  name: 'Home',\n  components: {\n    MarkDown,\n    Loading,\n    Pagination,\n    Cover,\n  },\n  data() {\n    return {\n      loading: false,\n      page: 0,\n      pageSize: 10,\n      posts: [],\n      list: [],\n      times: {},\n      LOAD_INX: 4,\n    }\n  },\n  computed: {\n    ...mapState({\n      totalCount: (state) => state.totalCount,\n    }),\n    maxPage() {\n      return Math.ceil(this.totalCount / this.pageSize)\n    },\n    isDisabledPrev() {\n      return this.page <= 1\n    },\n    isDisabledNext() {\n      return this.page >= this.maxPage\n    },\n  },\n  async created() {\n    if (!this.totalCount) {\n      await this.$store.dispatch('queryArchivesCount')\n    }\n    await this.queryPosts()\n\n    AOS.init({\n      duration: 2000,\n      easing: 'ease',\n      debounceDelay: 50,\n      throttleDelay: 100,\n      offset: 50,\n    })\n  },\n  methods: {\n    // 获取文章列表\n    async queryPosts(type = 'next') {\n      if (this.loading) return\n      const queryPage = type === 'prev' ? this.page - 1 : this.page + 1\n      this.page = queryPage\n      this.LOAD_INX = 4\n\n      if (this.list[queryPage]) {\n        this.scrollTop(() => {\n          this.posts = this.list[queryPage]\n        })\n        return\n      }\n\n      this.loading = true\n      const posts = await this.$store.dispatch('queryPosts', {\n        page: queryPage,\n        pageSize: this.pageSize,\n      })\n      this.loading = false\n\n      this.scrollTop(() => {\n        this.posts = posts\n        this.list[queryPage] = posts\n      })\n\n      // 获取文章热度\n      const ids = posts.map((o) => o.id)\n      const hot = await this.$store.dispatch('queryHot', { ids })\n      this.times = { ...this.times, ...hot }\n    },\n    // 滚动到顶部\n    scrollTop(cb) {\n      window.scrollTo({ top: 0, behavior: 'smooth' })\n      const delayTime = this.$isMobile.value ? 200 : 0\n      setTimeout(cb, 800 + delayTime)\n      setTimeout(AOS.refresh, 1200 + delayTime)\n    },\n    // 按顺序加载封面图\n    loadNext() {\n      this.LOAD_INX += 1\n    },\n    // 看板娘\n    showTips(post) {\n      const tips = `要去看看<span style=\"color: #b854d4\"> ${post.title} </span>吗？`\n      this.$store.dispatch('showTips', { tips })\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scope>\n@import './index.scss';\n</style>\n"]}]}