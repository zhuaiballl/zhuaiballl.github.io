{"remainingRequest":"/Users/guohechuan/code/aurora/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/guohechuan/code/aurora/src/views/Category/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/guohechuan/code/aurora/src/views/Category/index.vue","mtime":1626163653611},{"path":"/Users/guohechuan/code/aurora/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/guohechuan/code/aurora/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/guohechuan/code/aurora/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/guohechuan/code/aurora/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBMb2FkaW5nIGZyb20gJ0AvY29tcG9uZW50cy9Mb2FkaW5nJwppbXBvcnQgUXVvdGUgZnJvbSAnQC9jb21wb25lbnRzL1F1b3RlJwppbXBvcnQgQXJjaGl2ZUNhcmQgZnJvbSAnQC9jb21wb25lbnRzL0FyY2hpdmVDYXJkJwppbXBvcnQgQ29tbWVudCBmcm9tICdAL2NvbXBvbmVudHMvQ29tbWVudCcKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ2F0ZWdvcnknLAogIGNvbXBvbmVudHM6IHsKICAgIExvYWRpbmcsCiAgICBRdW90ZSwKICAgIEFyY2hpdmVDYXJkLAogICAgQ29tbWVudCwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgaW5pdENvbW1lbnQ6IGZhbHNlLAogICAgICBjYXRlZ29yeTogW10sCiAgICAgIG1pbGVzdG9uZTogJycsCiAgICAgIHRvdGFsQ291bnQ6IDAsCiAgICAgIHBhZ2U6IDAsCiAgICAgIHBhZ2VTaXplOiAxMCwKICAgICAgcG9zdHM6IFtdLAogICAgICBsaXN0OiBbXSwKICAgICAgdGltZXM6IHt9LAogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIG1heFBhZ2UoKSB7CiAgICAgIHJldHVybiBNYXRoLmNlaWwodGhpcy50b3RhbENvdW50IC8gdGhpcy5wYWdlU2l6ZSkKICAgIH0sCiAgICBpc0Rpc2FibGVkUHJldigpIHsKICAgICAgcmV0dXJuIHRoaXMucGFnZSA8PSAxCiAgICB9LAogICAgaXNEaXNhYmxlZE5leHQoKSB7CiAgICAgIHJldHVybiB0aGlzLnBhZ2UgPj0gdGhpcy5tYXhQYWdlCiAgICB9LAogIH0sCiAgYXN5bmMgY3JlYXRlZCgpIHsKICAgIGF3YWl0IHRoaXMucXVlcnlDYXRlZ29yeSgpCiAgICB0aGlzLmluaXRDb21tZW50ID0gdHJ1ZQogIH0sCiAgbWV0aG9kczogewogICAgLy8g6I635Y+W5YiG57G75YiX6KGoCiAgICBhc3luYyBxdWVyeUNhdGVnb3J5KCkgewogICAgICB0aGlzLmNhdGVnb3J5ID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3F1ZXJ5Q2F0ZWdvcnknKQogICAgfSwKICAgIC8vIOetm+mAieadoeS7tgogICAgYXN5bmMgaGFuZGxlRmlsdGVyKGNhdGVnb3J5KSB7CiAgICAgIGlmICh0aGlzLm1pbGVzdG9uZS5udW1iZXIgPT09IGNhdGVnb3J5Lm51bWJlcikgcmV0dXJuCiAgICAgIHRoaXMucmVzZXQoKQogICAgICB0aGlzLm1pbGVzdG9uZSA9IGNhdGVnb3J5CiAgICAgIHRoaXMudG90YWxDb3VudCA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdxdWVyeUZpbHRlckFyY2hpdmVzQ291bnQnLCB7IG1pbGVzdG9uZTogY2F0ZWdvcnkudGl0bGUgfSkKICAgICAgdGhpcy5maWx0ZXJQb3N0cygpCiAgICB9LAogICAgLy8g6YeN572uCiAgICByZXNldCgpIHsKICAgICAgdGhpcy5taWxlc3RvbmUgPSAnJwogICAgICB0aGlzLnRvdGFsQ291bnQgPSAwCiAgICAgIHRoaXMucGFnZSA9IDAKICAgICAgdGhpcy5saXN0ID0gW10KICAgICAgdGhpcy5wb3N0cyA9IFtdCiAgICB9LAogICAgLy8g5p+l5om+5paH56ugCiAgICBhc3luYyBmaWx0ZXJQb3N0cyh0eXBlID0gJ25leHQnKSB7CiAgICAgIGlmICh0aGlzLmxvYWRpbmcpIHJldHVybgogICAgICBjb25zdCBxdWVyeVBhZ2UgPSB0eXBlID09PSAncHJldicgPyB0aGlzLnBhZ2UgLSAxIDogdGhpcy5wYWdlICsgMQogICAgICB0aGlzLnBhZ2UgPSBxdWVyeVBhZ2UKCiAgICAgIGlmICh0aGlzLmxpc3RbcXVlcnlQYWdlXSkgewogICAgICAgIHRoaXMuc2Nyb2xsVG9wKCgpID0+IHsKICAgICAgICAgIHRoaXMucG9zdHMgPSB0aGlzLmxpc3RbcXVlcnlQYWdlXQogICAgICAgIH0pCiAgICAgICAgcmV0dXJuCiAgICAgIH0KCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgY29uc3QgZmlsdGVyID0gYCZtaWxlc3RvbmU9JHt0aGlzLm1pbGVzdG9uZS5udW1iZXJ9YAogICAgICBjb25zdCBwb3N0cyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdxdWVyeVBvc3RzJywgewogICAgICAgIHBhZ2U6IHF1ZXJ5UGFnZSwKICAgICAgICBwYWdlU2l6ZTogdGhpcy5wYWdlU2l6ZSwKICAgICAgICBmaWx0ZXIsCiAgICAgIH0pCgogICAgICB0aGlzLnNjcm9sbFRvcCgoKSA9PiB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICB0aGlzLnBvc3RzID0gcG9zdHMKICAgICAgICB0aGlzLmxpc3RbcXVlcnlQYWdlXSA9IHBvc3RzCiAgICAgIH0pCgogICAgICAvLyDojrflj5bmlofnq6Dng63luqYKICAgICAgY29uc3QgaWRzID0gcG9zdHMubWFwKChvKSA9PiBvLmlkKQogICAgICBjb25zdCBob3QgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgncXVlcnlIb3QnLCB7IGlkcyB9KQogICAgICB0aGlzLnRpbWVzID0geyAuLi50aGlzLnRpbWVzLCAuLi5ob3QgfQogICAgfSwKICAgIC8vIOa7muWKqOWIsOmhtumDqAogICAgc2Nyb2xsVG9wKGNiKSB7CiAgICAgIHdpbmRvdy5zY3JvbGxUbyh7IHRvcDogMCwgYmVoYXZpb3I6ICdzbW9vdGgnIH0pCiAgICAgIGNvbnN0IGRlbGF5VGltZSA9IHRoaXMuJGlzTW9iaWxlLnZhbHVlID8gODAwIDogNjAwCiAgICAgIHNldFRpbWVvdXQoY2IsIGRlbGF5VGltZSkKICAgIH0sCiAgfSwKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/Category","sourcesContent":["<template>\n  <div id=\"category\">\n    <Transition name=\"fade-transform\" mode=\"out-in\">\n      <div class=\"page\" v-if=\"category.length\">\n        <Quote :quote=\"$config.categoryOpts.qoute\" />\n        <Transition name=\"fade-transform\" mode=\"out-in\">\n          <div v-if=\"posts.length\">\n            <div class=\"clean\">\n              <span>Category:</span>\n              <span class=\"clean-btn cursor\" @click=\"reset\">\n                {{ milestone.title }}\n                <i class=\"icon icon-cancel-outline\"></i>\n              </span>\n            </div>\n            <ArchiveCard\n              :posts=\"posts\"\n              :times=\"times\"\n              :loading=\"loading\"\n              :isDisabledPrev=\"isDisabledPrev\"\n              :isDisabledNext=\"isDisabledNext\"\n              @handlePage=\"filterPosts\"\n            />\n          </div>\n          <Loading v-else-if=\"milestone\" />\n          <ul v-else class=\"content\">\n            <li class=\"cursor\" v-for=\"item in category\" :key=\"item.id\" @click=\"handleFilter(item)\">\n              <img class=\"bg\" :src=\"item.cover\" alt />\n              <div class=\"meta\">\n                <div>\n                  <img class=\"avatar\" :src=\"item.cover\" alt />\n                  <span>{{ item.title }} ({{ item.open_issues }})</span>\n                </div>\n                <p>{{ item.summary }}</p>\n              </div>\n            </li>\n          </ul>\n        </Transition>\n      </div>\n      <Loading v-else />\n    </Transition>\n\n    <Comment v-if=\"$config.categoryOpts.enableComment && initComment\" title=\"分类\" />\n  </div>\n</template>\n\n<script>\nimport Loading from '@/components/Loading'\nimport Quote from '@/components/Quote'\nimport ArchiveCard from '@/components/ArchiveCard'\nimport Comment from '@/components/Comment'\n\nexport default {\n  name: 'Category',\n  components: {\n    Loading,\n    Quote,\n    ArchiveCard,\n    Comment,\n  },\n  data() {\n    return {\n      loading: false,\n      initComment: false,\n      category: [],\n      milestone: '',\n      totalCount: 0,\n      page: 0,\n      pageSize: 10,\n      posts: [],\n      list: [],\n      times: {},\n    }\n  },\n  computed: {\n    maxPage() {\n      return Math.ceil(this.totalCount / this.pageSize)\n    },\n    isDisabledPrev() {\n      return this.page <= 1\n    },\n    isDisabledNext() {\n      return this.page >= this.maxPage\n    },\n  },\n  async created() {\n    await this.queryCategory()\n    this.initComment = true\n  },\n  methods: {\n    // 获取分类列表\n    async queryCategory() {\n      this.category = await this.$store.dispatch('queryCategory')\n    },\n    // 筛选条件\n    async handleFilter(category) {\n      if (this.milestone.number === category.number) return\n      this.reset()\n      this.milestone = category\n      this.totalCount = await this.$store.dispatch('queryFilterArchivesCount', { milestone: category.title })\n      this.filterPosts()\n    },\n    // 重置\n    reset() {\n      this.milestone = ''\n      this.totalCount = 0\n      this.page = 0\n      this.list = []\n      this.posts = []\n    },\n    // 查找文章\n    async filterPosts(type = 'next') {\n      if (this.loading) return\n      const queryPage = type === 'prev' ? this.page - 1 : this.page + 1\n      this.page = queryPage\n\n      if (this.list[queryPage]) {\n        this.scrollTop(() => {\n          this.posts = this.list[queryPage]\n        })\n        return\n      }\n\n      this.loading = true\n      const filter = `&milestone=${this.milestone.number}`\n      const posts = await this.$store.dispatch('queryPosts', {\n        page: queryPage,\n        pageSize: this.pageSize,\n        filter,\n      })\n\n      this.scrollTop(() => {\n        this.loading = false\n        this.posts = posts\n        this.list[queryPage] = posts\n      })\n\n      // 获取文章热度\n      const ids = posts.map((o) => o.id)\n      const hot = await this.$store.dispatch('queryHot', { ids })\n      this.times = { ...this.times, ...hot }\n    },\n    // 滚动到顶部\n    scrollTop(cb) {\n      window.scrollTo({ top: 0, behavior: 'smooth' })\n      const delayTime = this.$isMobile.value ? 800 : 600\n      setTimeout(cb, delayTime)\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import './index.scss';\n</style>\n"]}]}